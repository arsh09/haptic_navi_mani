<?xml version="1.0" ?>

<launch>

  <!-- This file provides an example for launching a Thorvald robot.
       Copy this file, together with any config files you wish to edit, to your own package before editing. -->
       
  <!-- Robot name and tf prefix -->
  <arg name="robot_name" default="" />
  <arg name="tf_prefix" default="" />
  <arg name="do_teleop" default="false" />

  <!--Â Path to tobot configuration file
       This file list modules on a given robot with key parameters like position in the base_link frame, gear ratios, etc.
       The robot description is then automatically generated from this file.
       Many examples are found in the thorvald_description package -->
  <arg name="robot_model" default="$(find thorvald_description)/config/thorvald_ii_4wd4ws_std/thorvald_ii_4wd4ws_std.yaml" />

  <!-- Path to model extras xacro file
       This file is used to define any mesh or tfs that are not automatically generated from the robot configuration file
       Examples include sensors and custom frame members
       Leave empty if no additional tfs or meshers are required -->
  <arg name="model_extras" default="$(find thorvald_description)/urdf/sensor_modules/sensor_frames_example.xacro" />

  <!-- Simulated or real robot.
       If set to True, the base driver node will simulate motor feedback. -->
  <arg name="simple_sim" default="True" />

  <!-- CAN interface.
       If you are running a real robot, you need to set the CAN interface type and name
       For robots fitted with the Main Enc. PCB (v1) REV6 can interface type is "enc_pcb_v1rev6" and name is the port
       For robots fitted with PCAN-USB adapters (or another socketcan device), interface type is "socketcan" and name is the socketcan interface
       Remember to uninstall old PCAN drivers or else it will not work with socketcan. -->
  <arg name="can_interface_type" default="enc_pcb_v2rev1" />
  <arg name="can_interface_name" default="/dev/ttyACM0" />

  <!-- Base odometry frame args
       If enable_odom_tf is true, the base driver node will broadcast a transform between the odometry frame and the base_link frame
       odom_frame_id sets the name of the odometry frame used in tf broadcast and odometry topic. -->
  <arg name="enable_odom_tf" default="True" />
  <arg name="odom_frame_id" default="odom" />

  <!-- Twist mux args
       twist and lock topics to be used by twist_mux, command multiplexer -->
  <arg name="twist_mux_topics" value="$(find thorvald_twist_mux)/config/twist_mux_topics.yaml" />
  <arg name="twist_mux_locks" value="$(find thorvald_twist_mux)/config/twist_mux_locks.yaml" />

  <!-- Teleop args
       The teleop node can be used with different hardware, and can also be configured to call any number of std_srvs/Trigger services.
       You can use xbox.yaml from thorvald_teleop as an example when configuring your own controller -->
  <arg name="joy_dev" default="/dev/input/js0" />
  <arg name="joy_autorepeat_rate" value="20" />
  <arg name="joy_deadzone" value="0.2" />
  <arg name="teleop_controller" value="$(find thorvald_teleop)/config/xbox.yaml" />


  <!-- Thorvald bringup -->
  <include file="$(find thorvald_bringup)/launch/thorvald_bringup.launch">
    <arg name="robot_name" value="$(arg robot_name)" />
    <arg name="tf_prefix" value="$(arg tf_prefix)" />
    <arg name="robot_model" value="$(arg robot_model)" />
    <arg name="model_extras" value="$(arg model_extras)" />
    <arg name="simple_sim" value="$(arg simple_sim)" />
    <arg name="enable_odom_tf" default="$(arg enable_odom_tf)" />
    <arg name="odom_frame_id" value="$(arg odom_frame_id)" />
    <arg name="can_interface_type" value="$(arg can_interface_type)" />
    <arg name="can_interface_name" value="$(arg can_interface_name)" />
  </include>


    <group if="$(arg do_teleop)">
        <!-- Twist mux bringup -->
        <include file="$(find thorvald_twist_mux)/launch/twist_mux.launch">
            <arg name="config_topics" value="$(arg twist_mux_topics)" />
            <arg name="config_locks" value="$(arg twist_mux_locks)" />
        </include>

        <!-- Teleop bringup -->
        <include file="$(find thorvald_teleop)/launch/teleop.launch">
            <arg name="joy_dev" value="$(arg joy_dev)" />
            <arg name="joy_autorepeat_rate" value="$(arg joy_autorepeat_rate)" />
            <arg name="joy_deadzone" value="$(arg joy_deadzone)" />
            <arg name="teleop_controller" value="$(arg teleop_controller)" />
        </include>
    </group>



</launch>
